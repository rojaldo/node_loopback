<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Loopback</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Loopback</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_1_introducción_a_loopback">1. Introducción a Loopback</a>
<ul class="sectlevel2">
<li><a href="#_qué_es_loopback">¿Qué es Loopback?</a></li>
<li><a href="#_historia_y_evolución_del_framework">Historia y Evolución del Framework</a></li>
<li><a href="#_ventajas_y_casos_de_uso">Ventajas y Casos de Uso</a></li>
</ul>
</li>
<li><a href="#_2_instalación_y_configuración_inicial">2. Instalación y Configuración Inicial</a>
<ul class="sectlevel2">
<li><a href="#_requisitos_previos_node_js_y_npm">Requisitos previos: Node.js y npm</a></li>
<li><a href="#_instalación_del_loopback_cli">Instalación del Loopback CLI</a></li>
<li><a href="#_creación_y_configuración_de_un_proyecto_loopback">Creación y configuración de un proyecto Loopback</a></li>
<li><a href="#_creación_de_un_controller">Creación de un Controller</a></li>
<li><a href="#_creación_de_un_servicio">Creación de un servicio</a></li>
<li><a href="#_creación_de_un_datasource">Creación de un datasource</a></li>
</ul>
</li>
<li><a href="#_3_arquitectura_de_loopback">3. Arquitectura de Loopback</a>
<ul class="sectlevel2">
<li><a href="#_estructura_de_un_proyecto_loopback">Estructura de un proyecto Loopback</a></li>
<li><a href="#_componentes_principales_controladores_repositorios_modelos_servicios_datasources">Componentes principales: Controladores, Repositorios, Modelos, Servicios, Datasources</a></li>
<li><a href="#_conexión_e_integración_con_bases_de_datos">Conexión e integración con bases de datos</a></li>
</ul>
</li>
<li><a href="#_4_desarrollo_de_apis_restful">4. Desarrollo de APIs RESTful</a>
<ul class="sectlevel2">
<li><a href="#_definición_de_modelos_y_relaciones">Definición de modelos y relaciones</a></li>
<li><a href="#_configuración_de_endpoints_y_rutas">Configuración de endpoints y rutas</a></li>
<li><a href="#_validaciones_y_manejo_de_errores_en_las_apis">Validaciones y manejo de errores en las APIs</a></li>
</ul>
</li>
<li><a href="#_5_integración_con_bases_de_datos">5. Integración con Bases de Datos</a>
<ul class="sectlevel2">
<li><a href="#_configuración_de_adaptadores_para_mysql_postgresql_y_mongodb">Configuración de adaptadores para MySQL, PostgreSQL y MongoDB</a></li>
<li><a href="#_migraciones_y_sincronización_de_modelos">Migraciones y sincronización de modelos</a></li>
<li><a href="#_ejemplos_prácticos">Ejemplos prácticos</a></li>
</ul>
</li>
<li><a href="#_6_autenticación_y_autorización">6. Autenticación y Autorización</a>
<ul class="sectlevel2">
<li><a href="#_implementación_de_estrategias_de_autenticación">Implementación de estrategias de autenticación</a></li>
<li><a href="#_uso_de_oauth2_y_jwt_tokens">Uso de OAuth2 y JWT tokens</a></li>
<li><a href="#_gestión_de_roles_y_permisos">Gestión de roles y permisos</a></li>
</ul>
</li>
<li><a href="#_7_buenas_prácticas_y_optimización">7. Buenas Prácticas y Optimización</a>
<ul class="sectlevel2">
<li><a href="#_manejo_de_errores_y_logging">Manejo de errores y logging</a></li>
<li><a href="#_optimización_del_rendimiento">Optimización del rendimiento</a></li>
<li><a href="#_pruebas_unitarias_e_integración_continua">Pruebas unitarias e integración continua</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_1_introducción_a_loopback">1. Introducción a Loopback</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_qué_es_loopback">¿Qué es Loopback?</h3>
<div class="paragraph">
<p>Loopback es un framework de Node.js diseñado para construir APIs RESTful de forma rápida y eficiente. Se basa en una arquitectura modular que permite la integración de múltiples fuentes de datos y facilita tareas comunes en el desarrollo backend, como validaciones, autenticación, y manejo de errores.</p>
</div>
</div>
<div class="sect2">
<h3 id="_historia_y_evolución_del_framework">Historia y Evolución del Framework</h3>
<div class="paragraph">
<p>Loopback inició como un proyecto de IBM para simplificar el desarrollo de backends para aplicaciones móviles y web. Con el tiempo, ha evolucionado incorporando mejoras tecnológicas y nuevas funcionalidades, convirtiéndose en una herramienta robusta y versátil que se adapta a las necesidades del desarrollo ágil y la integración de servicios modernos.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ventajas_y_casos_de_uso">Ventajas y Casos de Uso</h3>
<div class="paragraph">
<p>Loopback presenta varias ventajas:
* <strong>Generación Automática de APIs:</strong> Permite definir modelos de datos que se transforman automáticamente en endpoints RESTful.
* <strong>Flexibilidad en la Conexión de Datos:</strong> Facilita la integración con bases de datos SQL y NoSQL, así como con servicios externos.
* <strong>Seguridad Integrada:</strong> Ofrece mecanismos para autenticación y autorización de manera nativa.
* <strong>Comunidad y Soporte:</strong> Cuenta con una comunidad activa y extensa documentación, lo que facilita la resolución de problemas y la implementación de casos complejos.</p>
</div>
<div class="paragraph">
<p><strong>Casos de Uso Comunes:</strong>
* Desarrollo de microservicios.
* Creación de backends para aplicaciones móviles y web.
* Integración de múltiples fuentes de datos en entornos empresariales.
* Proyectos que requieren escalabilidad y una rápida generación de APIs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_instalación_y_configuración_inicial">2. Instalación y Configuración Inicial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_requisitos_previos_node_js_y_npm">Requisitos previos: Node.js y npm</h3>
<div class="listingblock">
<div class="title">Antes de comenzar, asegúrate de tener instalados Node.js y npm (Node Package Manager). Puedes verificar su instalación ejecutando los siguientes comandos en la terminal:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">node --version
npm --version</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si no están instalados, descárgalos e instálalos desde [<a href="https://nodejs.org" class="bare">https://nodejs.org</a>](<a href="https://nodejs.org" class="bare">https://nodejs.org</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_instalación_del_loopback_cli">Instalación del Loopback CLI</h3>
<div class="listingblock">
<div class="title">Loopback CLI es una herramienta de línea de comandos que facilita la creación y gestión de proyectos Loopback. Para instalarlo globalmente, ejecuta:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">npm install -g @loopback/cli</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verifica la instalación con:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">lb4 --help</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_y_configuración_de_un_proyecto_loopback">Creación y configuración de un proyecto Loopback</h3>
<div class="paragraph">
<p>Una vez instalado el CLI, crea un nuevo proyecto Loopback siguiendo estos pasos:</p>
</div>
<div class="listingblock">
<div class="title">Ejecuta el comando:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">   lb4 app</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Introduce el nombre del proyecto y responde a las preguntas de configuración (tipo de aplicación, integración con bases de datos, etc.)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">Project name: getting-started
? Project description: Getting started tutorial
? Project root directory: getting-started
? Application class name: StarterApplication
? Select features to enable in the project:
❯◉ Enable eslint: add a linter with pre-configured lint rules
 ◉ Enable prettier: install prettier to format code conforming to rules
 ◉ Enable mocha: install mocha to run tests
 ◉ Enable loopbackBuild: use @loopback/build helpers (e.g. lb-eslint)
 ◉ Enable editorconfig: add EditorConfig files
 ◉ Enable vscode: add VSCode config files
 ◉ Enable docker: include Dockerfile and .dockerignore
 ◉ Enable repositories: include repository imports and RepositoryMixin
 ◉ Enable services: include service-proxy imports and ServiceMixin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Al terminar, se habrá generado la estructura básica del proyecto, incluyendo carpetas para modelos, controladores y repositorios.</p>
</div>
<div class="listingblock">
<div class="title">Revisa el archivo <code>package.json</code> y utiliza el comando:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">npm start</code></pre>
</div>
</div>
<div class="paragraph">
<p>para iniciar el servidor y verificar que el entorno esté configurado correctamente.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_un_controller">Creación de un Controller</h3>
<div class="listingblock">
<div class="title">Para crear un controlador básico, utiliza el comando:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">lb4 controller</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Introduce el nombre del controlador y selecciona el tipo de controlador (REST, GraphQL, etc.). Por ejemplo:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">? Controller class name: hello
? What kind of controller would you like to generate? Empty Controller
  create src/controllers/hello.controller.ts
  update src/controllers/index.ts

Controller hello was now created in src/controllers/</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">En el archivo generado, define un método simple que responda a una solicitud GET:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import {get} from '@loopback/rest';

export class HelloController {
  @get('/hello')
  hello(): string {
    return 'Hello world!';
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Prueba el endpoint accediendo a <code><a href="http://localhost:3000/hello" class="bare">http://localhost:3000/hello</a></code> en tu navegador o utilizando herramientas como Postman.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_un_servicio">Creación de un servicio</h3>
<div class="paragraph">
<p>Para crear un servicio en Loopback, utiliza el CLI de Loopback y ejecuta el siguiente comando:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">lb4 service [opciones] [nombre del servicio]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación, se te indicará configurar el servicio mediante una serie de preguntas, como:
* Nombre del servicio.
* Tipo de servicio (por ejemplo, servicio personalizado para lógica de negocio o integración con APIs externas).
* Ruta de ubicación del archivo generado.</p>
</div>
<div class="ulist">
<div class="title">Las opciones pueden incluir:</div>
<ul>
<li>
<p><code>--type</code>: Especifica el tipo de servicio (por ejemplo, <code>custom</code>, <code>external</code>).</p>
</li>
<li>
<p><code>--datasource</code>: Indica la fuente de datos a la que se conectará el servicio, que se sepecifica en src/datasources.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Hay 3 tipos de servicios que puedes crear:</div>
<ul>
<li>
<p><code>proxy</code>: Para crear un servicio proxy que se conecte a un servicio externo remoto REST, SOAP, gRPC, etc. Tiene que haber un datasource configurado en src/datasources.</p>
</li>
<li>
<p><code>class</code>: Para crear un servicio de clase que encapsule la lógica de negocio.</p>
</li>
<li>
<p><code>provider</code>: Para crear un servicio que proporcione datos o lógica a otros componentes de la aplicación.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Una vez completado, se creará un archivo en el directorio <code>src/services/</code>, que contendrá la estructura básica del servicio. Por ejemplo, si creas un servicio llamado <code>MyService</code>, el archivo generado podría tener el siguiente contenido:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class MyService {
  constructor() {
    // Inicialización del servicio
  }

  /**
   * Método que implementa la lógica del servicio.
   * @param input Entrada para procesar
   * @returns Resultado procesado
   */
  process(input: string): string {
    // Lógica del servicio
    return `Resultado: ${input}`;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Este servicio se puede inyectar en controladores u otros componentes mediante el sistema de inyección de dependencias de Loopback. Por ejemplo, para usar el servicio en un controlador, puedes hacerlo de la siguiente manera:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import {inject} from '@loopback/core';
import {MyService} from '../services';

export class MyController {
  constructor(
    @inject('services.MyService') // Asegúrate de registrar el servicio
    private myService: MyService,
  ) {}

  // Ejemplo de endpoint que utiliza el servicio
  async ejemploEndpoint(): Promise&lt;string&gt; {
    const resultado = this.myService.process('Entrada de ejemplo');
    return resultado;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Con estos pasos, habrás creado e integrado correctamente un servicio en tu aplicación Loopback, lo que te permitirá encapsular y reutilizar lógica de negocio de forma modular y eficiente.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_un_datasource">Creación de un datasource</h3>
<div class="paragraph">
<p>Un datasource en Loopback es una configuración que define cómo se conecta la aplicación a una fuente de datos, como una base de datos SQL o NoSQL. Para crear un datasource.
.Para usar el CLI de Loopback y ejecuta el siguiente comando:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">lb4 datasource [options] [&lt;name&gt;]</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Las opciones pueden incluir:</div>
<ul>
<li>
<p><code>--connector</code>: Especifica el conector a utilizar (por ejemplo, <code>mysql</code>, <code>mongodb</code>, <code>postgresql</code>, etc.).</p>
</li>
<li>
<p><code>--config</code>: Permite especificar un archivo de configuración para el datasource.</p>
</li>
<li>
<p><code>--skip-cache</code>: Evita que se genere un archivo de caché para el datasource.</p>
</li>
<li>
<p><code>--skip-install</code>: Evita la instalación de dependencias adicionales.</p>
</li>
<li>
<p><code>--format</code>: Permite especificar el formato del código generado.</p>
</li>
<li>
<p><code>--yes</code>: Acepta todas las opciones por defecto sin preguntar.</p>
</li>
<li>
<p><code>--help</code>: Muestra la ayuda del comando.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_arquitectura_de_loopback">3. Arquitectura de Loopback</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La arquitectura de Loopback está pensada para aportar una estructura organizada y escalable, facilitando la separación de responsabilidades y la integración con diversas fuentes de datos.</p>
</div>
<div class="sect2">
<h3 id="_estructura_de_un_proyecto_loopback">Estructura de un proyecto Loopback</h3>
<div class="paragraph">
<p>Un proyecto Loopback típico se organiza en una serie de carpetas que ayudan a mantener el código modularizado y fácil de mantener. Algunas de las carpetas y archivos principales son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>src/</strong>: Contiene el código fuente de la aplicación.</p>
</li>
<li>
<p><strong>models/</strong>: Define los modelos de datos que representan las entidades del dominio.</p>
</li>
<li>
<p><strong>controllers/</strong>: Gestiona la lógica de negocio y responde a las solicitudes HTTP.</p>
</li>
<li>
<p><strong>repositories/</strong>: Encapsula la lógica de acceso y manipulación de datos, facilitando la conexión con bases de datos u otros servicios.</p>
</li>
<li>
<p><strong>datasources/</strong>: Configura las conexiones a las bases de datos y otros proveedores de datos.</p>
</li>
<li>
<p><strong>routes/</strong> (opcional): Define rutas y mapea endpoints a controladores, en caso de querer una organización adicional.</p>
</li>
<li>
<p><strong>package.json</strong>: Archivo de configuración de Node.js, que incluye dependencias y scripts de arranque.</p>
</li>
<li>
<p><strong>.env</strong>: Archivo opcional para definir variables de entorno que configuran aspectos del entorno de ejecución (por ejemplo, detalles de conexión a bases de datos).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Esta estructura permite que cada componente de la aplicación tenga un rol definido y se integre de forma coherente en el conjunto del proyecto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_componentes_principales_controladores_repositorios_modelos_servicios_datasources">Componentes principales: Controladores, Repositorios, Modelos, Servicios, Datasources</h3>
<div class="paragraph">
<p>El diseño modular de Loopback se basa en tres componentes esenciales:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Controladores:</strong>
Encargados de manejar las solicitudes HTTP, los controladores contienen la lógica de negocio de la aplicación. Se comunican con los repositorios para recuperar o modificar datos y devuelven respuestas adecuadas a los clientes.</p>
</li>
<li>
<p><strong>Modelos:</strong>
Representan las entidades de datos y definen sus propiedades, validaciones y relaciones. Los modelos en Loopback se utilizan para generar automáticamente endpoints RESTful, facilitando la exposición de operaciones CRUD sin necesidad de configuración adicional.</p>
</li>
<li>
<p><strong>Repositorios:</strong>
Actúan como una capa intermedia entre los modelos y las fuentes de datos. Los repositorios gestionan las operaciones de acceso a datos y encapsulan la lógica de integración con bases de datos, servicios externos o APIs. Esto permite modificar la fuente de datos sin afectar la lógica de negocio contenida en los modelos y controladores.</p>
</li>
<li>
<p><strong>Servicios:</strong>
Proporcionan lógica adicional o integración con servicios externos o internos. Los servicios pueden ser utilizados por los controladores para realizar tareas específicas, como enviar correos electrónicos, interactuar con APIs de terceros o realizar cálculos complejos.</p>
</li>
<li>
<p><strong>Datasources:</strong>
Configuran las conexiones a las fuentes de datos, como bases de datos SQL o NoSQL. Los datasources definen los parámetros de conexión y permiten a los repositorios interactuar con diferentes fuentes de datos sin necesidad de reescribir la lógica de acceso.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_controladores">Controladores</h4>
<div class="paragraph">
<p>Los controladores son la puerta de entrada a la lógica de negocio de la aplicación. Cada controlador se asocia a un conjunto de rutas y maneja las solicitudes HTTP correspondientes. Loopback permite definir controladores RESTful que responden a métodos HTTP (GET, POST, PUT, DELETE) y generan automáticamente la documentación Swagger (OpenAPI) para cada endpoint.</p>
</div>
<div class="paragraph">
<p>Los controladores pueden ser personalizados para manejar la lógica de negocio específica, como validaciones adicionales, transformaciones de datos o integración con otros servicios.
Por ejemplo, un controlador de productos podría tener métodos para listar productos, crear nuevos productos y actualizar o eliminar productos existentes. Cada método se asocia a una ruta específica y puede recibir parámetros de entrada a través de la URL o el cuerpo de la solicitud.</p>
</div>
<div class="paragraph">
<p>El constructor de un controlador puede inyectar dependencias, como repositorios o servicios, utilizando el decorador <code>@inject</code>. Esto permite que los controladores sean modulares y reutilizables, facilitando la separación de responsabilidades y la gestión de la lógica de negocio.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un controlador que inyecta un repositorio y un servicio</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/controllers/product.controller.ts
import {inject} from '@loopback/core';
import {repository} from '@loopback/repository';
import {get, post, requestBody} from '@loopback/rest';
import {ProductRepository} from '../repositories/product.repository';
import {MyService} from '../services/my.service';

export class ProductController {
  constructor(
    @repository(ProductRepository)
    private productRepository: ProductRepository,
    @inject('services.MyService')
    private myService: MyService,
  ) {}

  // Endpoint GET para obtener la lista de productos
  @get('/products')
  async listProducts(): Promise&lt;object&gt; {
    const products = await this.productRepository.find();
    return { products };
  }

  // Endpoint POST para crear un nuevo producto y utilizar el servicio
  @post('/products')
  async createProduct(
    @requestBody() product: object,
  ): Promise&lt;object&gt; {
    const createdProduct = await this.productRepository.create(product);
    // Procesa lógica adicional con el servicio inyectado
    this.myService.process('Producto creado');
    return createdProduct;
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Para crear documentación OpenAPI a medida, tenemos la anotación <code>@api</code> que permite definir la documentación de cada endpoint. Por ejemplo:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/controllers/product.controller.ts
import {inject} from '@loopback/core';
import {repository} from '@loopback/repository';
import {get, post, requestBody, api} from '@loopback/rest';
import {Product} from '../models/product.model';
import {ProductRepository} from '../repositories/product.repository';
import {MyService} from '../services/my.service';

export class ProductController {
  constructor(
    @repository(ProductRepository)
    private productRepository: ProductRepository,
    @inject('services.MyService')
    private myService: MyService,
  ) {}

  @api({
    summary: 'Obtiene la lista de todos los productos',
    responses: {
      '200': {
        description: 'Productos listados exitosamente',
        content: {
          'application/json': {
            schema: {
              type: 'array',
              items: {'x-ts-type': Product},
            },
          },
        },
      },
    },
  })
  @get('/products')
  async listProducts(): Promise&lt;Product[]&gt; {
    return this.productRepository.find();
  }

  @api({
    summary: 'Crea un nuevo producto',
    requestBody: {
      content: {
        'application/json': {
          schema: {'x-ts-type': Product},
        },
      },
    },
    responses: {
      '200': {
        description: 'Producto creado exitosamente',
        content: {
          'application/json': {
            schema: {'x-ts-type': Product},
          },
        },
      },
    },
  })
  @post('/products')
  async createProduct(
    @requestBody() product: Product,
  ): Promise&lt;Product&gt; {
    this.myService.process('Producto creado');
    return this.productRepository.create(product);
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Un trolador puede recibir parámetros en:</div>
<ul>
<li>
<p>El cuerpo de la solicitud (request body). Con <code>@requestBody</code>.</p>
</li>
<li>
<p>Las consultas (query parameters). Con <code>@param.query</code>.</p>
</li>
<li>
<p>Los parámetros de ruta (path parameters). Con <code>@param.path</code>.</p>
</li>
<li>
<p>Los encabezados (headers). Con <code>@param.header</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de controlador que utiliza diferentes tipos de parámetros en Loopback</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/controllers/example.controller.ts
import {post, get, requestBody, param} from '@loopback/rest';

export class ExampleController {
  @post('/items/{id}')
  async createItem(
    @param.path.number('id') id: number,
    @param.query.string('filter') filter: string,
    @param.header.string('x-custom-header') customHeader: string,
    @requestBody() body: {name: string; description?: string},
  ): Promise&lt;object&gt; {
    // Ejemplo de procesamiento de los parámetros recibidos
    return {
      id,
      filter,
      customHeader,
      body,
    };
  }

  /**
   * Endpoint GET que utiliza un parámetro de ruta para obtener un ítem.
   */
  @get('/items/{id}')
  async getItem(
    @param.path.number('id') id: number,
    @param.query.string('verbose') verbose?: string,
  ): Promise&lt;object&gt; {
    return {
      id,
      verbose,
      message: `Obteniendo el item con id ${id}`,
    };
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Una de las funciones más importantes de los controladores es la gestión de las respuestas HTTP. Loopback permite devolver diferentes tipos de respuestas según el resultado de la operación, como códigos de estado HTTP, mensajes personalizados o datos en formato JSON.</p>
</div>
<div class="paragraph">
<p>Esto se logra utilizando los métodos <code>res.status()</code> y <code>res.json()</code>, que permiten establecer el código de estado y el cuerpo de la respuesta, respectivamente.</p>
</div>
<div class="paragraph">
<p>Para los errores, Loopback proporciona la clase <code>HttpErrors</code>, que permite lanzar errores HTTP con códigos de estado específicos y mensajes personalizados. Esto facilita el manejo de errores y la comunicación clara con los clientes de la API.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un método post que devuelve un código de estado 201 y un mensaje personalizado en caso de éxito y un 400 en caso de error con HttpErrors</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/controllers/status.controller.ts
import {
  post,
  requestBody,
  HttpErrors,
  Response,
  RestBindings,
  inject,
} from '@loopback/rest';

export class StatusController {
  constructor(
    @inject(RestBindings.Http.RESPONSE) private res: Response,
  ) {}

  @post('/create-item')
  async createItem(
    @requestBody() item: {name?: string; [key: string]: any},
  ): Promise&lt;object&gt; {
    try {
      // Validación simple: se requiere el nombre del ítem
      if (!item || !item.name) {
        throw new Error('El nombre del ítem es requerido');
      }
      // Lógica de creación (simulada)
      const createdItem = {id: 1, ...item};

      // Establece el código de estado 201 y retorna el mensaje de éxito
      this.res.status(201);
      return {
        message: 'Ítem creado exitosamente',
        data: createdItem,
      };
    } catch (error) {
      // En caso de error, se lanza un error Http con estado 400 y mensaje personalizado
      throw new HttpErrors.BadRequest(error.message || 'Error al crear el ítem');
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modelos">Modelos</h4>
<div class="paragraph">
<p>Los modelos son la representación de las entidades del dominio en Loopback. Definen las propiedades, tipos de datos y validaciones necesarias para cada entidad, así como las relaciones entre diferentes modelos.</p>
</div>
<div class="paragraph">
<p>Los modelos se generan automáticamente a partir de las definiciones de datos y se utilizan para crear automáticamente los endpoints RESTful correspondientes. Esto permite que los desarrolladores se centren en la lógica de negocio sin preocuparse por la implementación de la API.</p>
</div>
<div class="ulist">
<div class="title">Los modelos en Loopback son altamente configurables y permiten definir propiedades como:</div>
<ul>
<li>
<p><strong>Propiedades:</strong> Definición de los atributos del modelo, incluyendo tipos de datos, longitudes y validaciones.</p>
</li>
<li>
<p><strong>Relaciones:</strong> Definición de las relaciones entre diferentes modelos, como uno a uno, uno a muchos o muchos a muchos.</p>
</li>
<li>
<p><strong>Validaciones:</strong> Configuración de reglas de validación para asegurar la integridad de los datos, como campos requeridos, formatos específicos o valores únicos.</p>
</li>
<li>
<p><strong>Métodos personalizados:</strong> Posibilidad de definir métodos adicionales en los modelos para realizar operaciones específicas o cálculos relacionados con la entidad.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Las anotaciones de relaciones son:</div>
<ul>
<li>
<p><code>@hasMany</code>: Define una relación uno a muchos, donde un modelo puede tener múltiples instancias de otro modelo.</p>
</li>
<li>
<p><code>@hasOne</code>: Define una relación uno a uno, donde un modelo tiene una única instancia de otro modelo.</p>
</li>
<li>
<p><code>@belongsTo</code>: Define una relación de pertenencia, donde un modelo pertenece a otro modelo.</p>
</li>
<li>
<p><code>@hasManyThrough</code>: Define una relación muchos a muchos a través de un modelo intermedio.</p>
</li>
<li>
<p><code>@ReferencesMany</code>: Define una relación de referencia, donde un modelo puede referenciar múltiples instancias de otro modelo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Por ejemplo, un modelo de producto podría tener propiedades como <code>id</code>, <code>nombre</code>, <code>precio</code> y <code>categoría</code>, así como relaciones con otros modelos como <code>Categoría</code> o <code>Proveedor</code>. Esto permite que los desarrolladores trabajen con objetos de dominio en lugar de lidiar directamente con consultas SQL o comandos específicos de la base de datos.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un modelo de producto en Loopback con propiedades y relaciones</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/models/product.model.ts
import {Entity, model, property, belongsTo} from '@loopback/repository';
import {Category} from './category.model';
import {Provider} from './provider.model';

@model({
  settings: {},
})
export class Product extends Entity {
  @property({
    type: 'number',
    id: true,
    generated: true,
  })
  id?: number;

  @property({
    type: 'string',
    required: true,
  })
  nombre: string;

  @property({
    type: 'number',
    required: true,
  })
  precio: number;

  // Relación: Un producto pertenece a una categoría
  @belongsTo(() =&gt; Category)
  categoriaId: number;

  // Relación: Un producto es suministrado por un proveedor
  @belongsTo(() =&gt; Provider)
  proveedorId: number;

  constructor(data?: Partial&lt;Product&gt;) {
    super(data);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_repositorios">Repositorios</h4>
<div class="paragraph">
<p>Los repositorios son componentes clave en Loopback que facilitan la interacción con las fuentes de datos. Actúan como una capa de abstracción entre los modelos y las bases de datos, permitiendo realizar operaciones CRUD (Crear, Leer, Actualizar, Eliminar) de manera sencilla y eficiente.</p>
</div>
<div class="paragraph">
<p>Los repositorios se generan automáticamente a partir de los modelos y se configuran para conectarse a las fuentes de datos definidas en el proyecto. Esto permite que los desarrolladores trabajen con objetos de dominio en lugar de lidiar directamente con consultas SQL o comandos específicos de la base de datos.</p>
</div>
<div class="paragraph">
<p>Los repositorios pueden incluir métodos personalizados para realizar consultas específicas o manipular datos de manera más compleja. Además, Loopback proporciona una serie de métodos predefinidos para realizar operaciones comunes, como <code>find()</code>, <code>create()</code>, <code>update()</code>, y <code>delete()</code>.
Por ejemplo, un repositorio de productos podría tener métodos para buscar productos por nombre, actualizar el precio de un producto o eliminar un producto específico. Estos métodos pueden ser utilizados directamente en los controladores o en otros componentes de la aplicación.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un repositorio que extiende el repositorio base de Loopback</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {inject} from '@loopback/core';
import {DefaultCrudRepository} from '@loopback/repository';
import {DbDataSource} from '../datasources';
import {Todo, TodoRelations} from '../models';

export class TodoRepository extends DefaultCrudRepository&lt;
  Todo,
  typeof Todo.prototype.id,
  TodoRelations
&gt; {
  constructor(@inject('datasources.db') dataSource: DbDataSource) {
    super(Todo, dataSource);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_servicios">Servicios</h4>
<div class="paragraph">
<p>Los servicios en Loopback son componentes que encapsulan la lógica de negocio y permiten la reutilización de código en diferentes partes de la aplicación. Los servicios pueden ser utilizados por los controladores, repositorios u otros servicios, facilitando la separación de responsabilidades y la modularidad del código.</p>
</div>
<div class="paragraph">
<p>Los servicios pueden incluir lógica de negocio compleja, integración con APIs externas, procesamiento de datos o cualquier otra funcionalidad que no encaje directamente en los modelos o controladores. Esto permite que los desarrolladores mantengan el código limpio y organizado, evitando la duplicación de lógica en diferentes partes de la aplicación.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un servicio que realiza una operación específica en Loopback</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class MyService {
  constructor() {
    // Inicialización del servicio si es necesario
  }

  process(input: string): string {
    // Ejemplo de lógica: convertir el texto a mayúsculas y agregar un prefijo.
    return `Resultado procesado: ${input.toUpperCase()}`;
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de inyección de un servicio en un controlador utilizando el decorador @inject</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// filepath: /home/rojaldo/cursos/node/curso_loopback/src/controllers/order.controller.ts
import {inject} from '@loopback/core';
import {get} from '@loopback/rest';
import {MyService} from '../services/my.service';

export class OrderController {
  constructor(
    @inject('services.MyService')
    private myService: MyService,
  ) {}

  // Endpoint GET que utiliza el servicio inyectado para procesar una orden
  @get('/order/process')
  processOrder(): object {
    const result = this.myService.process('Orden procesada');
    return {message: result};
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datasources">Datasources</h4>
<div class="paragraph">
<p>Los datasources son componentes que configuran la conexión a las fuentes de datos, como bases de datos SQL o NoSQL. En Loopback, los datasources permiten a los repositorios interactuar con diferentes fuentes de datos sin necesidad de reescribir la lógica de acceso.</p>
</div>
<div class="paragraph">
<p>Los datasources se definen en archivos de configuración y pueden incluir detalles como el tipo de conector (por ejemplo, MySQL, MongoDB), la URL de conexión, las credenciales y otros parámetros necesarios para establecer la conexión.</p>
</div>
<div class="paragraph">
<p>Los datasources pueden ser utilizados por los repositorios para realizar operaciones CRUD y consultas a las bases de datos. Esto permite que los desarrolladores trabajen con objetos de dominio en lugar de lidiar directamente con consultas SQL o comandos específicos de la base de datos.</p>
</div>
<div class="listingblock">
<div class="title">Un ejemplo de un datasource configurado para una base de datos MySQL</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {juggler} from '@loopback/repository';
import {inject} from '@loopback/core';

const config = {
  name: 'mysqlDs',
  connector: 'mysql',
  host: 'localhost',
  port: 3306,
  user: 'tuUsuario',
  password: 'tuContraseña',
  database: 'nombreDeLaBaseDeDatos'
};

export class MysqlDataSource extends juggler.DataSource {
  static dataSourceName = 'mysqlDs';

  constructor(
    @inject('datasources.config.mysqlDs', {optional: true})
    dsConfig: object = config,
  ) {
    super(dsConfig);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interceptores">Interceptores</h4>
<div class="paragraph">
<p>Los interceptores en Loopback son componentes que permiten inyectar lógica adicional en el ciclo de vida de una solicitud, similar a lo que hace un middleware. Su función es ejecutar código antes, durante o después de la ejecución de un endpoint, lo que facilita:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La gestión centralizada de errores.</p>
</li>
<li>
<p>El registro (logging) de eventos.</p>
</li>
<li>
<p>La aplicación de validaciones o transformaciones de datos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un interceptor global se registra a nivel de la aplicación (por ejemplo, mediante el método <code>this.interceptor(&#8230;&#8203;)</code> en la configuración de la aplicación). Esto significa que se aplica a <strong>todas</strong> las invocaciones de métodos dentro de la aplicación, permitiendo centralizar funcionalidades transversales como manejo de errores, logging o validaciones.</p>
</div>
<div class="paragraph">
<p>En cambio, un interceptor no global se vincula a componentes, controladores o métodos específicos. Solo se ejecuta en aquellas invocaciones en las que se ha configurado explícitamente, dando un control más fino sobre dónde y cuándo se desea aplicar la lógica de intercepción.</p>
</div>
<div class="listingblock">
<div class="title">Por ejemplo, el siguiente interceptor captura errores durante la ejecución de un endpoint y los transforma en respuestas HTTP consistentes:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">  async intercept(
    invocationCtx: InvocationContext,
    next: () =&gt; ValueOrPromise&lt;InvocationResult&gt;,
  ) {
    try {
      // Add pre-invocation logic here
      console.log(`Intercepting ${invocationCtx.targetName}.${invocationCtx.methodName}`);

      const result = await next();
      // Add post-invocation logic here
      console.log(`Result: ${JSON.stringify(result)}`);
      return result;
    } catch (err) {
      // Add error handling logic here
      throw err;
    }
  }</code></pre>
</div>
</div>
<div class="olist arabic">
<div class="title">Los parámetros del interceptor son:</div>
<ol class="arabic">
<li>
<p><strong>invocationCtx: InvocationContext</strong>
Este objeto representa el contexto de la invocación actual. Contiene información importante como:</p>
<div class="ulist">
<ul>
<li>
<p>El nombre del objeto (por ejemplo, un controlador o servicio) y el método que se está invocando.</p>
</li>
<li>
<p>Los argumentos pasados al método.</p>
</li>
<li>
<p>Otros metadatos que pueden ser útiles para personalizar el comportamiento del interceptor.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>next: () &#8658; ValueOrPromise&lt;InvocationResult&gt;</strong>
Este es un callback que, al ser invocado, continúa la cadena de ejecución. Algunas características son:</p>
<div class="ulist">
<ul>
<li>
<p>Permite llamar al siguiente interceptor registrado o, si no hay más, ejecutar el método original.</p>
</li>
<li>
<p>Puede devolver un valor de forma síncrona o una promesa (para operaciones asíncronas).</p>
</li>
<li>
<p>El retorno de <code>next()</code> representa el resultado final de la invocación, el cual puede ser manipulado o registrado por el interceptor antes de retornarlo.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">El interceptor definido anteriormente se puede aplicar a un controlador específico o a toda la aplicación. Para aplicarlo a un controlador, se puede utilizar el decorador <code>@intercept</code> en la clase del controlador:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {intercept, get} from '@loopback/rest';
import {ErrorInterceptor} from '../interceptors/error.interceptor';

@intercept(SampleInterceptor.BINDING_KEY)
export class MyController {

  @get('/mi-endpoint')
  async miEndpoint(): Promise&lt;object&gt; {
    // Lógica del endpoint
    return {message: 'Funciona con interceptor'};
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Un interceptor a nivel de método sería aplicado de la siguiente manera:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {intercept, get} from '@loopback/rest';
import {ErrorInterceptor} from '../interceptors/error.interceptor';

export class MyController {

  @get('/mi-endpoint')
  @intercept(ErrorInterceptor.BINDING_KEY)
  async miEndpoint(): Promise&lt;object&gt; {
    // Lógica del endpoint
    return {message: 'Respuesta del endpoint con interceptor a nivel de método'};
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>El método invokeMethod se utiliza para invocar un método de un objeto (por ejemplo, de un controlador o servicio) de forma que se active la cadena de interceptores registrados. Esto garantiza que, antes, durante o después de la ejecución del método, se ejecute la lógica definida en los interceptores, tanto globales como específicos.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, en lugar de llamar directamente al método:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">const result = await controller.create(aTodo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede invocar el método utilizando invokeMethod de la aplicación:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">const result = await app.invokeMethod(controller, 'create', [aTodo]);</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">De esta forma, invokeMethod:</div>
<ul>
<li>
<p>Resuelve y ejecuta todos los interceptores asociados al método 'create'.</p>
</li>
<li>
<p>Permite centralizar funcionalidades transversales como el manejo de errores, logging o validaciones.</p>
</li>
<li>
<p>Garantiza que la lógica adicional definida en los interceptores se aplique en la cadena de ejecución antes de retornar el resultado final.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El paquete @loopback/core provee la función createProxyWithInterceptors, que permite envolver un objeto (por ejemplo, un controlador o servicio) en un proxy. De este modo, se aplican interceptores en cada invocación de sus métodos, lo que posibilita la ejecución de lógica adicional como logging, manejo de errores o validaciones sin modificar la implementación original.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
  createProxyWithInterceptors,
  Interceptor,
  InvocationContext,
  InvocationResult,
  ValueOrPromise,
} from '@loopback/core';

// Definición de un interceptor de ejemplo que realiza logging
const loggingInterceptor: Interceptor = async (
  invocationCtx: InvocationContext,
  next: () =&gt; ValueOrPromise&lt;InvocationResult&gt;,
) =&gt; {
  console.log(`Antes de invocar ${invocationCtx.targetName}.${invocationCtx.methodName}`);
  const result = await next();
  console.log(`Después de invocar ${invocationCtx.targetName}.${invocationCtx.methodName}: ${JSON.stringify(result)}`);
  return result;
};

// Suponiendo que 'controller' es una instancia de un controlador o servicio,
// se crea un proxy que aplica el interceptor definido.
const proxiedController = createProxyWithInterceptors(controller, {
  interceptors: [loggingInterceptor],
});

// Al invocar métodos del controlador a través del proxy, se activan los interceptores.
async function testProxy() {
  // Por ejemplo, llamar al método 'create' del controlador
  const result = await proxiedController.create(aTodo);
  console.log('Resultado final:', result);
}

testProxy();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conexión_e_integración_con_bases_de_datos">Conexión e integración con bases de datos</h3>
<div class="paragraph">
<p>Loopback simplifica la integración con diversas bases de datos y otras fuentes de información mediante el uso de adaptadores (connectors). Entre las características principales se encuentran:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Adaptadores de Datos:</strong>
Loopback soporta múltiples conectores para bases de datos SQL (como MySQL, PostgreSQL) y NoSQL (como MongoDB). Esto permite a los desarrolladores trabajar con el motor de base de datos que mejor se adapte a las necesidades del proyecto.</p>
</li>
<li>
<p><strong>Configuración y Conexión:</strong>
Las conexiones a bases de datos se configuran en el directorio <strong>datasources/</strong>. Cada fuente de datos se define en un archivo con la configuración necesaria (credenciales, URL, parámetros de conexión), lo que permite conectar la aplicación con la base de datos sin alterar el código central de la aplicación.</p>
</li>
<li>
<p><strong>Migraciones y Sincronización de Modelos:</strong>
Loopback ofrece herramientas para la migración y sincronización de modelos con las estructuras de las bases de datos, facilitando la gestión evolutiva del esquema de datos. Esto es particularmente útil en entornos ágiles donde los requisitos pueden cambiar con el tiempo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Esta separación de la configuración de la base de datos y la lógica de negocio garantiza que la aplicación pueda adaptarse rápidamente a nuevos requisitos y que la integración con fuentes externas sea sencilla y mantenible.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_desarrollo_de_apis_restful">4. Desarrollo de APIs RESTful</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_definición_de_modelos_y_relaciones">Definición de modelos y relaciones</h3>
<div class="paragraph">
<p>En Loopback, los modelos representan las entidades del dominio y se definen mediante archivos de configuración (generalmente en JSON o TypeScript). Cada modelo especifica las propiedades, validaciones y relaciones con otros modelos. Las relaciones pueden ser de uno a muchos, muchos a uno o muchos a muchos, permitiendo estructurar de forma coherente la lógica y las conexiones entre entidades.</p>
</div>
<div class="paragraph">
<p>Ejemplo básico de un modelo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "name": "Product",
  "properties": {
    "id": {
      "type": "number",
      "id": true,
      "generated": true
    },
    "name": {
      "type": "string",
      "required": true
    },
    "price": {
      "type": "number",
      "required": true
    }
  },
  "relations": {
    "category": {
      "type": "belongsTo",
      "model": "Category"
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuración_de_endpoints_y_rutas">Configuración de endpoints y rutas</h3>
<div class="paragraph">
<p>Loopback genera automáticamente endpoints RESTful a partir de los modelos definidos, facilitando la exposición inmediata de operaciones CRUD. No obstante, es común personalizar o añadir rutas específicas para satisfacer requisitos particulares.</p>
</div>
<div class="paragraph">
<p>Para ello, se definen controladores que gestionan la lógica del negocio. Cada método del controlador se asocia a una ruta concreta mediante decoradores o configuraciones en el archivo de rutas. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import {get, post, requestBody} from '@loopback/rest';

export class ProductController {
  @get('/products')
  async listProducts() {
    // Lógica para obtener la lista de productos
  }

  @post('/products')
  async createProduct(@requestBody() product: object) {
    // Lógica para crear un nuevo producto
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validaciones_y_manejo_de_errores_en_las_apis">Validaciones y manejo de errores en las APIs</h3>
<div class="paragraph">
<p>Loopback integra validaciones a nivel de modelo para asegurar la integridad de los datos. Estas validaciones, como campos requeridos o patrones de formato, se configuran directamente en la definición del modelo.</p>
</div>
<div class="paragraph">
<p>Además, el framework implementa un manejo centralizado de errores a través de interceptores y middleware. Esto permite capturar errores en cualquier parte de la cadena de procesamiento y devolver respuestas consistentes al cliente. Por ejemplo, se puede definir un interceptor para registrar y formatear los errores antes de enviarlos como respuesta:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import {Interceptor, InvocationContext, InvocationResult, Provider} from '@loopback/context';
import {HttpErrors} from '@loopback/rest';

export class ErrorInterceptor implements Interceptor {
  async intercept(ctx: InvocationContext, next: () =&gt; Promise&lt;InvocationResult&gt;): Promise&lt;InvocationResult&gt; {
    try {
      return await next();
    } catch (err) {
      // Lógica para manejar y formatear el error
      throw new HttpErrors.InternalServerError('Ocurrió un error en la API');
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Con estas estrategias, Loopback garantiza que las APIs sean robustas, seguras y fáciles de mantener.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_integración_con_bases_de_datos">5. Integración con Bases de Datos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Esta sección abarca la conexión de la aplicación Loopback con diversas bases de datos utilizando adaptadores, la sincronización de modelos con la base de datos y ejemplos prácticos para afianzar los conceptos.</p>
</div>
<div class="sect2">
<h3 id="_configuración_de_adaptadores_para_mysql_postgresql_y_mongodb">Configuración de adaptadores para MySQL, PostgreSQL y MongoDB</h3>
<div class="paragraph">
<p>Loopback soporta distintos conectores para acceder a bases de datos SQL y NoSQL. Para configurar cada uno, se debe crear un archivo en el directorio <strong>datasources/</strong> que contenga los parámetros de conexión. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">/* Ejemplo para MySQL */
{
  "name": "mysqlDs",
  "connector": "mysql",
  "host": "localhost",
  "port": 3306,
  "user": "tuUsuario",
  "password": "tuContraseña",
  "database": "nombreDeLaBaseDeDatos"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">/* Ejemplo para PostgreSQL */
{
  "name": "postgresDs",
  "connector": "postgresql",
  "host": "localhost",
  "port": 5432,
  "user": "tuUsuario",
  "password": "tuContraseña",
  "database": "nombreDeLaBaseDeDatos"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">/* Ejemplo para MongoDB */
{
  "name": "mongoDs",
  "connector": "mongodb",
  "url": "mongodb://localhost:27017/nombreDeLaBaseDeDatos"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cada archivo define el adaptador a usar y las credenciales necesarias para la conexión.</p>
</div>
</div>
<div class="sect2">
<h3 id="_migraciones_y_sincronización_de_modelos">Migraciones y sincronización de modelos</h3>
<div class="paragraph">
<p>Loopback ofrece métodos para mantener sincronizados los modelos definidos en la aplicación con los esquemas de la base de datos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Automigrate:</strong> Elimina y vuelve a crear las tablas basándose en el modelo definido; útil en entornos de desarrollo.</p>
</li>
<li>
<p><strong>Autoupdate:</strong> Actualiza la estructura de la base de datos sin eliminar los datos existentes; ideal para entornos de producción.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Se pueden invocar estos métodos en el archivo de inicio de la aplicación o a través de scripts personalizados. Por ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">async function migrateSchema(app) {
  const ds = app.datasources.mysqlDs;
  await ds.automigrate(); // O bien: await ds.autoupdate();
  console.log('Migración completada');
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>De esta forma, se garantiza que los cambios en los modelos se reflejen en la base de datos de forma controlada.</p>
</div>
<div class="sect3">
<h4 id="_inyección_del_objeto_response">Inyección del objeto response</h4>
<div class="paragraph">
<p>En Loopback es posible inyectar el objeto response en un controlador para poder manipular directamente la respuesta HTTP. Con el decorador @inject y el binding RestBindings.Http.RESPONSE se puede acceder a este objeto de forma sencilla. A continuación, se muestra un ejemplo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {Response, RestBindings} from '@loopback/rest';
import {inject} from '@loopback/core';

export class PingController {
  constructor(@inject(RestBindings.Http.RESPONSE) private response: Response) {}

  @get('/ping')
  ping(): Response {
    // Access the response object via `this.response`
    this.response.status(200).send({
      greeting: 'Hello from LoopBack',
      date: new Date(),
    });
    // Return the HTTP response object so that LoopBack framework skips the
    // generation of HTTP response
    return this.response;
  }

  @get('/header')
  header(): string {
    // Set custom http response header
    this.response.set('x-custom-res-header', 'xyz');
    return 'Hello';
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uso_del_objeto_context_para_acceder_a_request_y_response">Uso del objeto context para acceder a request y response</h4>
<div class="paragraph">
<p>En LoopBack se puede acceder al objeto context para obtener instancias de la solicitud y respuesta HTTP a través de inyección de dependencias. Esto permite realizar operaciones como extraer información de la solicitud (por ejemplo, la IP del cliente) o modificar la respuesta (por ejemplo, agregando encabezados personalizados). A continuación se muestra un ejemplo de cómo hacerlo en un controlador:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {RequestContext, RestBindings} from '@loopback/rest';
import {inject} from '@loopback/core';

export class PingController {
  constructor(
    @inject(RestBindings.Http.CONTEXT) private requestCtx: RequestContext,
  ) {}

  ping(): Response {
    const {request, response} = this.requestCtx;
    this.response.status(200).send({
      greeting: 'Hello from LoopBack',
      date: new Date(),
      url: this.req.url,
      headers: Object.assign({}, this.req.headers),
    });
    // Return the HTTP response object so that LoopBack framework skips the
    // generation of HTTP response
    return response;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uso_de_middleware_para_acceder_a_request_y_response">Uso de Middleware para acceder a request y response</h4>
<div class="paragraph">
<p>En Loopback puedes definir middlewares para interceptar y manipular la solicitud (request) y la respuesta (response) en el ciclo de vida de la petición. Esto es útil para tareas como logging, autenticación, o modificación de cabeceras.</p>
</div>
<div class="paragraph">
<p>Un ejemplo de middleware que accede a ambos objetos es el siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {Middleware, MiddlewareContext} from '@loopback/rest';
import {debugFactory} from 'debug';
import {v1} from 'uuid';
const trace = debugFactory('trace:request-response');

/**
 * An middleware for tracing HTTP requests/responses
 * @param ctx - Context object
 * @param next - Downstream middleware/handlers
 */
export const tracingMiddleware: Middleware = async (ctx, next) =&gt; {
  setupRequestId(ctx);
  const {request, response} = ctx;
  try {
    if (trace.enabled) {
      const reqObj = {
        method: request.method,
        originalUrl: request.originalUrl,
        headers: request.headers,
        // Body is not available yet before `parseParams`
      };
      trace('Request: %s', reqObj);
    }
    const result = await next();
    if (trace.enabled) {
      const resObj = {
        statusCode: response.statusCode,
        headers: response.getHeaders(),
      };
      trace('Response: %s', resObj);
    }
    return result;
  } catch (err) {
    if (trace.enabled) {
      trace('Error: %s', err);
    }
    throw err;
  }
};

function setupRequestId(ctx: MiddlewareContext) {
  let requestId = ctx.request?.get('X-Request-ID');
  debug(
    'RequestID for %s %s: %s',
    ctx.request.method,
    ctx.request.originalUrl,
    requestId,
  );
  if (requestId == null) {
    requestId = v1();
    debug(
      'A new RequestID is generated for %s %s: %s',
      ctx.request.method,
      ctx.request.originalUrl,
      requestId,
    );
  }

  // Bind `request.id` so that it is available for injection in downstream
  // controllers/services
  ctx.bind('request.id').to(requestId);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para utilizar este middleware, regístralo en el arreglo de middlewares de tu aplicación Loopback, normalmente en el archivo de configuración o en el constructor de la aplicación.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ejemplos_prácticos">Ejemplos prácticos</h3>
<div class="paragraph">
<p>Para consolidar los conceptos, se recomienda realizar ejercicios prácticos tales como:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Conexión y operación CRUD:</strong>
Configura una datasource (por ejemplo, MySQL), define un modelo (como "Product"), y prueba operaciones de creación, lectura, actualización y eliminación utilizando los endpoints generados automáticamente por Loopback.</p>
</li>
<li>
<p><strong>Migración de esquemas:</strong>
Modifica el modelo "Product" (agregando nuevos campos) y utiliza el método de migración para actualizar la estructura de la base de datos sin perder datos existentes.</p>
</li>
<li>
<p><strong>Integración con múltiples bases de datos:</strong>
Configura dos datasources (por ejemplo, PostgreSQL para datos transaccionales y MongoDB para registros de logs) y muestra cómo separar las operaciones de acceso a datos según la necesidad del proyecto.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Estos ejemplos prácticos facilitan el entendimiento de la integración de Loopback con diversos motores de base de datos, permitiendo adaptar la solución a diferentes requerimientos y escenarios.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_autenticación_y_autorización">6. Autenticación y Autorización</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_implementación_de_estrategias_de_autenticación">Implementación de estrategias de autenticación</h3>
<div class="paragraph">
<p>Loopback permite integrar diversas estrategias de autenticación para validar la identidad de los usuarios. Esto puede incluir:
* Autenticación basada en sesiones y certificados.
* Uso de API keys para acceso restringido.
* Integración con proveedores externos (por ejemplo, LDAP o redes sociales).</p>
</div>
<div class="paragraph">
<p>La configuración se realiza mediante componentes que encapsulan la lógica de cada estrategia, permitiendo sustituir o combinar métodos según los requisitos del proyecto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_uso_de_oauth2_y_jwt_tokens">Uso de OAuth2 y JWT tokens</h3>
<div class="paragraph">
<p>Para gestionar autorizaciones de manera segura y escalable, se recomienda:
* <strong>OAuth2:</strong> Establece un flujo seguro para que aplicaciones de terceros accedan a recursos protegidos. Configura proveedores de OAuth2 y define scopes de acceso.
* <strong>JWT Tokens:</strong> Se generan al autenticar a un usuario y se incluyen en las solicitudes subsiguientes para verificar la identidad y permisos. La validación del token se realiza en cada endpoint protegido, garantizando que sólo usuarios autorizados puedan acceder a determinados recursos.</p>
</div>
<div class="paragraph">
<p>La combinación de OAuth2 y JWT proporciona una solución robusta para la autenticación, permitiendo la delegación de credenciales y la administración simplificada de sesiones.</p>
</div>
</div>
<div class="sect2">
<h3 id="_gestión_de_roles_y_permisos">Gestión de roles y permisos</h3>
<div class="paragraph">
<p>La autorización en Loopback se puede gestionar mediante la asignación de roles a los usuarios y la definición de permisos específicos para cada rol. Algunas prácticas incluyen:
* <strong>Asignación de Roles:</strong> Definir roles como administrador, usuario y invitado, y asignarlos durante la autenticación o en el proceso de registro.
* <strong>Control de Acceso:</strong> Implementar middleware o interceptores que verifiquen si el rol del usuario tiene permisos para ejecutar la acción solicitada.
* <strong>Políticas de Seguridad:</strong> Configurar restricciones a nivel de endpoint, modelo o método, permitiendo adaptar la autorización a los requerimientos de la aplicación.</p>
</div>
<div class="paragraph">
<p>Estas estrategias permiten crear una arquitectura segura y flexible para gestionar tanto la autenticación como la autorización en tus APIs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_7_buenas_prácticas_y_optimización">7. Buenas Prácticas y Optimización</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_manejo_de_errores_y_logging">Manejo de errores y logging</h3>
<div class="paragraph">
<p>Para garantizar la fiabilidad y mantenibilidad de la aplicación, es fundamental implementar un manejo de errores consistente y un sistema de logging robusto. Algunas recomendaciones incluyen:
* Uso de interceptores o middleware para capturar y formatear errores de forma centralizada.
* Registro de errores en archivos o sistemas de monitoreo para facilitar la depuración.
* Configuración de niveles de logging (debug, info, warn, error) acorde al entorno (desarrollo o producción).</p>
</div>
<div class="paragraph">
<p>Ejemplo de un interceptor para manejo de errores:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import {Interceptor, InvocationContext, InvocationResult} from '@loopback/context';
import {HttpErrors} from '@loopback/rest';

export class ErrorInterceptor implements Interceptor {
  async intercept(ctx: InvocationContext, next: () =&gt; Promise&lt;InvocationResult&gt;): Promise&lt;InvocationResult&gt; {
    try {
      return await next();
    } catch (err) {
      console.error('Error en la API:', err);
      throw new HttpErrors.InternalServerError('Error interno del servidor');
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optimización_del_rendimiento">Optimización del rendimiento</h3>
<div class="paragraph">
<p>Para mejorar el rendimiento de la aplicación se pueden aplicar diversas estrategias:
* Optimización de consultas a la base de datos mediante índices y consultas eficientes.
* Implementación de caching para respuestas frecuentes en endpoints críticos.
* Uso de procesos asíncronos y manejo adecuado de recursos para evitar bloqueos.
* Monitoreo y profiling de la aplicación para identificar y corregir cuellos de botella.</p>
</div>
<div class="paragraph">
<p>Estas técnicas ayudan a mantener tiempos de respuesta aceptables y a escalar la aplicación de manera eficiente.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pruebas_unitarias_e_integración_continua">Pruebas unitarias e integración continua</h3>
<div class="paragraph">
<p>La calidad del código se garantiza mediante un robusto conjunto de pruebas:
* Pruebas unitarias: Se encargan de validar la funcionalidad aislada de cada componente (modelos, controladores, repositorios).
* Pruebas de integración: Verifican la correcta interacción entre componentes y el acceso a recursos externos.
* Integración continua (CI): Automatiza la ejecución de pruebas con cada cambio en el código, detectando errores de forma temprana y asegurando un despliegue confiable.</p>
</div>
<div class="paragraph">
<p>Ejemplo básico utilizando Mocha y Chai:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const {expect} = require('chai');
const {Calculator} = require('../src/calculator');

describe('Calculator', () =&gt; {
  it('should correctly add two numbers', () =&gt; {
    const calc = new Calculator();
    expect(calc.add(2, 3)).to.equal(5);
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implementar estas prácticas contribuye a la creación de aplicaciones robustas, seguras y fáciles de mantener.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-04-04 07:45:50 +0200
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>